# Firestore Security Rules - ×”×•×¨××•×ª ×”×ª×§× ×”

## ğŸ“‹ ×¡×§×™×¨×” ×›×œ×œ×™×ª

×§×•×‘×¥ `firestore.rules` ××›×™×œ ××ª ×›×œ×œ×™ ×”××‘×˜×—×” ×©×œ Firestore ×©××‘×˜×™×—×™× ×©×›×œ ××©×ª××© ×™×›×•×œ ×œ×’×©×ª ×¨×§ ×œ× ×ª×•× ×™× ×©×œ×•.

## ğŸ”’ ×›×œ×œ×™ ×”××‘×˜×—×”

×”×›×œ×œ×™× ××‘×˜×™×—×™×:

1. **××™××•×ª ××©×ª××©×™×**: ×¨×§ ××©×ª××©×™× ××—×•×‘×¨×™× ×™×›×•×œ×™× ×œ×’×©×ª ×œ× ×ª×•× ×™×
2. **×‘×™×“×•×“ × ×ª×•× ×™×**: ×›×œ ××©×ª××© ×™×›×•×œ ×œ×’×©×ª ×¨×§ ×œ× ×ª×•× ×™× ×©×œ×• (`userId == request.auth.uid`)
3. **×”×’× ×” ××œ××”**: ×›×œ ×”× ×ª×•× ×™× ××•×’× ×™× ×œ×¤×™ ××©×ª××©

## ğŸ“ ××‘× ×” ×”× ×ª×•× ×™×

×”×›×œ×œ×™× ××’× ×™× ×¢×œ ×”××‘× ×” ×”×‘×:

```
artifacts/
  â””â”€â”€ {appId}/
      â””â”€â”€ users/
          â””â”€â”€ {userId}/
              â”œâ”€â”€ assets/          # × ×›×¡×™× ×¤×™× × ×¡×™×™×
              â”œâ”€â”€ settings/         # ×”×’×“×¨×•×ª ××¢×¨×›×ª
              â”‚   â”œâ”€â”€ config       # ×”×’×“×¨×•×ª ×§×˜×’×•×¨×™×•×ª, ×¤×œ×˜×¤×•×¨××•×ª, ××›×©×™×¨×™×
              â”‚   â””â”€â”€ currencyRate # ×©×¢×¨ ×—×œ×™×¤×™×Ÿ
              â”œâ”€â”€ reports/         # ×“×•×—×•×ª ×™×•×¢×¥ AI
              â””â”€â”€ dashboard_widgets/ # ×’×¨×¤×™× ×•×•×™×“×’'×˜×™×
```

## ğŸš€ ×”×ª×§× ×”

### ×©×™×˜×” 1: ×“×¨×š Firebase Console

1. ×¤×ª×— ××ª [Firebase Console](https://console.firebase.google.com/)
2. ×‘×—×¨ ××ª ×”×¤×¨×•×™×§×˜ ×©×œ×š
3. ×¢×‘×•×¨ ×œ-**Firestore Database** > **Rules**
4. ×”×¢×ª×§ ××ª ×”×ª×•×›×Ÿ ×-`firestore.rules`
5. ×”×“×‘×§ ×‘-Console
6. ×œ×—×¥ ×¢×œ **Publish**

### ×©×™×˜×” 2: ×“×¨×š Firebase CLI

```bash
# ×”×ª×§×Ÿ Firebase CLI ×× ×¢×“×™×™×Ÿ ×œ× ×”×ª×§× ×ª
npm install -g firebase-tools

# ×”×ª×—×‘×¨ ×œ×—×©×‘×•×Ÿ Firebase ×©×œ×š
firebase login

# ×‘×—×¨ ××ª ×”×¤×¨×•×™×§×˜
firebase use <your-project-id>

# ×”×¢×œ×” ××ª ×”×›×œ×œ×™×
firebase deploy --only firestore:rules
```

## âœ… ×‘×“×™×§×ª ×”×›×œ×œ×™×

×œ××—×¨ ×”×¢×œ××ª ×”×›×œ×œ×™×, ×ª×•×›×œ ×œ×‘×“×•×§ ××•×ª× ×‘-Firebase Console:

1. ×¢×‘×•×¨ ×œ-**Firestore Database** > **Rules**
2. ×œ×—×¥ ×¢×œ **Simulator** (×‘×ª×—×ª×™×ª ×”×“×£)
3. ×‘×“×•×§ ×ª×¨×—×™×©×™× ×©×•× ×™×:
   - ××©×ª××© ××—×•×‘×¨ ×× ×¡×” ×œ×’×©×ª ×œ× ×ª×•× ×™× ×©×œ×• âœ…
   - ××©×ª××© ××—×•×‘×¨ ×× ×¡×” ×œ×’×©×ª ×œ× ×ª×•× ×™× ×©×œ ××©×ª××© ××—×¨ âŒ
   - ××©×ª××© ×œ× ××—×•×‘×¨ ×× ×¡×” ×œ×’×©×ª ×œ× ×ª×•× ×™× âŒ

## ğŸ” ××” ×”×›×œ×œ×™× ×¢×•×©×™×?

### 1. ×¤×•× ×§×¦×™×•×ª ×¢×–×¨

```javascript
// ×‘×•×“×§ ×× ×”××©×ª××© ××—×•×‘×¨
function isAuthenticated() {
  return request.auth != null;
}

// ×‘×•×“×§ ×× ×”××©×ª××© ×”×•× ×”×‘×¢×œ×™× ×©×œ ×”× ×ª×•× ×™×
function isOwner(userId) {
  return isAuthenticated() && request.auth.uid == userId;
}
```

### 2. ×›×œ×œ×™ ×’×™×©×”

- **assets**: ×§×¨×™××” ×•×›×ª×™×‘×” ×¨×§ ×œ×‘×¢×œ×™×
- **settings**: ×§×¨×™××” ×•×›×ª×™×‘×” ×¨×§ ×œ×‘×¢×œ×™×
- **reports**: ×§×¨×™××” ×•×›×ª×™×‘×” ×¨×§ ×œ×‘×¢×œ×™×
- **dashboard_widgets**: ×§×¨×™××” ×•×›×ª×™×‘×” ×¨×§ ×œ×‘×¢×œ×™×

### 3. ×”×’× ×” ×›×œ×œ×™×ª

×›×œ × ×ª×•× ×™× ×©×œ× ×ª×•×××™× ×œ××‘× ×” ×œ×¢×™×œ × ×—×¡××™×.

## âš ï¸ ×”×¢×¨×•×ª ×—×©×•×‘×•×ª

1. **×œ×¤× ×™ ×”×¢×œ××” ×œ×™×™×¦×•×¨**: ×•×“× ×©×”×›×œ×œ×™× ×¢×•×‘×“×™× ×‘×¡×‘×™×‘×ª ×¤×™×ª×•×—
2. **×’×™×‘×•×™**: ×©××•×¨ ×¢×•×ª×§ ×©×œ ×”×›×œ×œ×™× ×”×™×©× ×™× ×œ×¤× ×™ ×¢×“×›×•×Ÿ
3. **×‘×“×™×§×”**: ×ª××™×“ ×‘×“×•×§ ××ª ×”×›×œ×œ×™× ×‘-Simulator ×œ×¤× ×™ ×”×¢×œ××”

## ğŸ› ï¸ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×©×’×™××ª ×”×¨×©××•×ª

×× ××ª×” ××§×‘×œ ×©×’×™××ª ×”×¨×©××•×ª:

1. ×•×“× ×©×”××©×ª××© ××—×•×‘×¨ (`request.auth != null`)
2. ×•×“× ×©×”-`userId` ×ª×•×× ×œ-`request.auth.uid`
3. ×‘×“×•×§ ××ª ×”-Console ×‘-Firebase ×œ×¨××•×ª ××™×–×” ×›×œ×œ ×—×¡× ××ª ×”×’×™×©×”

### ×‘×“×™×§×ª ×œ×•×’×™×

×‘-Firebase Console:
- **Firestore Database** > **Usage** > **Rules** - ×œ×¨××•×ª ×¡×˜×˜×™×¡×˜×™×§×•×ª
- **Firestore Database** > **Rules** > **Simulator** - ×œ×‘×“×•×§ ×ª×¨×—×™×©×™×

## ğŸ“š ××©××‘×™× × ×•×¡×¤×™×

- [Firestore Security Rules Documentation](https://firebase.google.com/docs/firestore/security/get-started)
- [Firebase Security Rules Testing](https://firebase.google.com/docs/firestore/security/test-rules)

